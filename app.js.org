App = Ember.Application.create({});

// TODO handle network errors

/** ADAPTERS **/
DS.RESTAdapter.reopen({});
App.ApiKeyAdapter = DS.LSAdapter.extend({});

/** SERIALIZERS **/
App.ApplicationSerializer = DS.RESTSerializer.extend({});

/** ROUTER MAP **/
App.Router.map(function() {});

/** ROUTES **/
App.LoadingRoute = Ember.Route.extend({});
App.ApplicationRoute = Ember.Route.extend({});
App.ProductsRoute = Ember.Route.extend({});
App.ProductsIndexRoute = Ember.Route.extend({});
App.ProductEditRoute = Ember.Route.extend({});
App.ProductsNewRoute = Ember.Route.extend({});
App.AuthenticatedRoute = Ember.Route.extend({});
App.SessionsRoute = Ember.Route.extend({});
App.SecretRoute = App.AuthenticatedRoute.extend({});
App.UsersSignupRoute = Ember.Route.extend({});

/** CONTROLLERS **/
App.ApplicationController = Ember.Controller.extend({});

App.IndexController = Ember.Controller.extend({
});

App.UsersSignupController = Ember.Controller.extend({});
App.SessionsController = Ember.Controller.extend({});
App.ProductsController = Ember.ArrayController.extend({});

App.ProductsNewController = Ember.ObjectController.extend({
    // TODO: Not DRY
    needs: ['sessions'],
    isAdmin: (function() {
        var res = this.get('controllers.sessions.currentUser.is_admin');
        console.log('ProductsNewController: isAdmin = '+res);
        return res;
    }).property('controllers.sessions.currentUser')
});

App.ProductController = Ember.ObjectController.extend({});

App.ProductEditController = Ember.ObjectController.extend({
    // TODO: Not DRY
    needs: ['sessions'],
    isAdmin: (function() {
        var res = this.get('controllers.sessions.currentUser.is_admin');
        console.log('ProductEditController: isAdmin = '+res);
        return res;
    }).property('controllers.sessions.currentUser')
});

App.ProductIndexController = Ember.ObjectController.extend({});
App.ProductEditController = Ember.ObjectController.extend({});
App.ProductsNewController = Ember.ObjectController.extend({});

App.UsersUserController = Ember.ObjectController.extend({
    // TODO: Not DRY
    needs: ['sessions'],
    isAdmin: (function() {
        var res = this.get('controllers.sessions.currentUser.is_admin');
        console.log('UsersUserController: isAdmin = '+res);
        return res;
    }).property('controllers.sessions.currentUser'),

    actions: {
        editProfile: function() {
            alert('Sorry, not yet implemented (be patient)');
        }
    }
});

App.SecretController = Ember.ObjectController.extend({
    // TODO: Not DRY
    needs: ['sessions'],
    isAdmin: (function() {
        var res = this.get('controllers.sessions.currentUser.is_admin');
        console.log('SecretController: isAdmin = '+res);
        return res;
    }).property('controllers.sessions.currentUser')
});

/** MODELS **/
App.Product = DS.Model.extend({});
App.User = DS.Model.extend({});
App.ApiKey = DS.Model.extend({});

/** HANDLEBAR HELPERS **/
Ember.Handlebars.helper('truncate', function(value, options) {});
Ember.Handlebars.helper('pluralize', function(number, options) {});
Ember.Handlebars.helper('fromnow', function(context) {});
Ember.Handlebars.helper('formatvalue', function(value, options) {});
Ember.Handlebars.helper('yesno', function(b) {});
